# Project06-控制

## 要求

本次作业中，我们将拓展`Evaluator`类的`eval`方法，从而实现`do`语句，`if`语句和`fn*`语句

我们测试用例保证输入的程序都是合法的，**没有词法、语法或语义错误**。

## 新增执行规则

在本次作业中，我们引入三条新的执行规则

1. `do`语句。对于`LList`类型的对象，当其内容不为空且第一个元素为`LSymbol(do)`时，它代表一个`do`语句。`do`语句会依次执行`LList`中的元素（从第2个开始），并将最后一个元素作为返回值

   ```txt
   (do (+ 1 2) (- 1 2) (* 1 2)) => 2
   ```

2. `if`语句。对于`LList`类型的对象，当其内容不为空且第一个元素为`LSymbol(if)`时，它代表一个`if`语句。`if`语句首先执行`LList`中的第2个元素，若其返回值为`LList()`或`LInteger(0)`（我们约定这些结果为`False`）时，执行并返回`LList`中第4个元素，否则执行并返回`LList`中的第3个元素

   ```txt
   (if (do 0) 1 2) => 2
   ```

3. `fn*`语句。对于`LList`类型的对象，当其内容不为空且第一个元素为`LSymbol(fn*)`时，它代表一个`fn*`语句。`fn*`语句创建一个函数闭包。首先，你需要创建一个新的环境，使用外层环境`env`作为`parent`[^1]，`LList`中第2个元素作为`binds`参数，将调用闭包的参数作为`args`参数；其次，当闭包函数被调用时，你需要使用刚才创建的新的环境，执行`LList`中的第3个元素，并返回其结果

   ```
   ((fn* (a) a) 123 ) => 123
   ```

[^1]: 温馨提醒：请进行深拷贝
